## hive sql

1. 取出用户一天内第二个时间的订单数据

    |user_id|order_time​|
    |--|--|
    |1001|2020-08-31 09:00|
    |1001|2020-08-31 10:00|
    |1001|2020-08-31 11:00|
    |...

    结果
    |user_id|order_time​|
    |--|--|
    |1001|2020-08-31 10:00|
    |...

2. 有如下表按照分类抽取样例数据总用1000条

    |goods|good_type|
    |--|--|
    |奶瓶|母婴|
    |T恤衫|衣服|
    |小米8|手机|
    |...

    要求按照 母婴60% 衣服20% 手机20% 抽取总共1000条数据

3. 有日活表，如何统计1、2、3日留存用户数

    |user_id|start_time|
    |--|--|
    |1001|2020-08-31 09:00|
    |1001|2020-08-30 10:00|
    |1002|2020-08-29 11:00|
    |1002|2020-08-31 09:00|
    |1001|2020-08-27 10:00|
    |1002|2020-08-26 11:00|
    |...


4. 有四张表，统计四张表里的数据来源

    a表
    |user_id|
    |--|
    |1001

    b表
    |user_id|
    |--|
    |1002
    |1003

    c表
    |user_id|
    |--|
    |1001

    d表
    |user_id|
    |--|
    |1003

    要求得出以下结果

    d表
    |user_id|source_table|
    |--|--|
    |1001|a,c|
    |1002|b|
    |1003|b,d|

## 其他

1. spark写出wordcount
2. hive的底层原理
3. mysql的存储引擎有什么
4. redis怎么做持久化
